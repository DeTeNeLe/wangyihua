
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>邀请注册 - {$settings.name}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <link media="all" rel="stylesheet" href="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/styles/base.css" type="text/css">
    <link media="all" rel="stylesheet" href="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/styles/master.css" type="text/css">
    {$add_css}
</head>
<body>
    <form id="inputForm" action="?" method="post" autocomplete="off">
        <input type="hidden" name="tid" value="494">
        <input type="hidden" name="rec" value="save" />
        <div class="main">
            <div class="w_loginbox">
                <h1> <img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/logo.png" alt="" /> </h1>

                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_01.fb021dd5.png" alt="" /></label>
                    <input type="text" class="w_registerinput  required form-control" name="userName" id="userName" value="" maxlength="20" minlength="6" placeholder="请填写会员编号" required>
                    <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close_02.png" alt="" /></i>
                </div>
                <!--
                <div class="hr"></div>
                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/tel.png" alt="" /></label>
                    <input type="tel" name="phone" id="phone" value="" maxlength="11" required class="w_registerinput required phone form-control" placeholder="请填写联系电话">
                    <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close_02.png" alt="" /></i>
                </div>

                <div class="hr"></div>
                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_02.png" alt="" /></label>
                    <input type="text" name="verify_code" id="verify_code" value="" maxlength="50" required class="w_registerinput required form-control" placeholder="请填写手机验证码">
                    <input name="获取验证码" value="获取验证码" type="button" class="w_acquire" onClick="send_msg()" />
                    <i class="w_acquire w_countdown">60S</i>
                </div>
				-->

                <div class="hr"></div>
                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/tuijian.png" alt="" /></label>
                    <input type="txt" value="{$tj_user.ue_account}" maxlength="50" required class="w_registerinput required  form-control" readonly>
                    <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close_02.png" alt="" /></i>
                </div>

                <div class="hr"></div>
                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/pwd.png" alt="" /></label>
                    <input type="password" name="pwd" id="pwd" value="" required maxlength="20" minlength="6" class="w_registerinput required form-control" placeholder="请填写登录密码">
                    <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close.png" alt="" /></i>
                </div>

                <div class="hr"></div>
                <div class="w_register">
                    <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/confirmNewPwd.png" alt="" /></label>
                    <input id="confirmNewPwd" name="confirmNewPwd" type="password" required value="" maxlength="20" minlength="6" class="w_registerinput required form-control" placeholder="确认登录密码" equalto="#pwd">
                    <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close.png" alt="" /></i>
                </div>

                <div class="hr"></div>
                <div class="w_label_buttonbox">
                    <button class="w_purebutton btnregister" type="submit" id="send_btn" name="send_btn">提交</button>
                </div>
                <div class="w_bottomtxt">
                    <a href="{:U('/login/index')}" class="rose">返回登录</a>
                </div>

                <div id="login_error">
                    <p style=" display:none;">We're sorry. Please try again！</p>
                </div>
            </div>
        </div>
    </form>
    <script src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/javascripts/jquery-1.9.1.min.js" type="text/javascript"></script>
    <script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
    <script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>


    <script>
        $("#inputForm").validate({
            rules: {
                userName: {
                    required: true,
                    minlength: 6,
                    maxlength: 20,
                },
                phone: {
                    required: true,
                    minlength: 11,
                    maxlength: 11,
                    digits: true
                },
                idCard: {
                    required: true,
                    checkcard: true
                },

                pwd: {
                    required: true,
                    //checkpwd1:true
                }
            },
            messages: {
                userName: {
                    required: '请输入会员编号',
                    maxlength: '会员编号不大于20位',
                    minlength: '会员编号不少于6位'
                },
                //idCard: {
                    //required: '请输入身份证号'
                //},
                //email: {
                //	email: '请输入正确邮箱格式',
                //	required: '请输入电子邮件'
                //},
                //phone: {
                    //digits: '请输入正确电话格式',
                    //required: '请输入联系电话',
                    //minlength: '请输入正确电话格式',
                    //maxlength: '请输入正确电话格式'
                //},

                pwd: {
                    required: '请输入登录密码',
                    maxlength: '登录密码不大于20位',
                    minlength: '登录密码不少于6位'
                },
                confirmNewPwd: {
                    equalTo: '请输入相同的登录密码',
                    required: '请再输入一次登录密码',
                    maxlength: '登录密码不大于20位',
                    minlength: '登录密码不少于6位'
                }
            },
            errorContainer: "#messageBox",
            errorPlacement: function (error, element) {
                if (element.is(":checkbox") || element.is(":radio") || element.parent().is(".input-append")) {
                    error.appendTo(element.parent().parent());
                } else {
                    error.insertAfter(element);
                }
            }
        });

        $.validator.addMethod("checkcard", function (value, element, params) {
            var checkCard = /^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X|x)$/;
            return this.optional(element) || (checkCard.test(value));
        }, "*请输入正确的身份证号！");

        $.validator.addMethod("checkpwd1", function (value, element, params) {
            var checkV = /^(?![\d]+$)(?![a-zA-Z]+$)(?![^\da-zA-Z]+$).{8,20}$/;
            return this.optional(element) || (checkV.test(value));
        }, "*请输入正确的密码,必须是8~20位字母数字或特殊符号组合！");


        function checkreg(checkName) {
            var msg = '输入有误,请先更正!';
            var regform = document.all.reg;
            var username = document.getElementById(checkName);
            var usern = /^[A-Z0-9_]{1,}$/;
            if (checkName == "userName") {
                document.getElementById('userName').value = document.getElementById('userName').value.toUpperCase();
                usern = /^[A-Z0-9\\-]{1,}$/;;
                msg += '会员编号支持输入大写字母、数字、中划线\n';
            } else if (checkName == "banknum") {
                usern = /^[a-zA-Z0-9\\*]{1,}$/;
                msg += '银行帐号支持输入字母、数字、星号\n';
                $("#accountMsg").text("");
            } else if (checkName == "pwd" || checkName == "pwdTran") {
                var v = $('#' + checkName).val();
                if (!/[0-9a-zA-Z\-\!]{6,}/g.test(v) || !/[0-9]{1,}/g.test(v) || !/[a-z]{1,}/g.test(v) || !/[A-Z]{1,}/g.test(v) || !/[\-\!]{1,}/g.test(v)) {
                    alert("密码必须6位以上的大小写字符、数字、特殊字符混合！");
                    return false;
                }
            }

            if (!username.value == "" && !username.value.match(usern)) {
                if (checkName == "userName") {
                    $("#userNameMsg1").text('');
                    document.getElementById('userName').value = "";
                    $("#userNameMsg").text(msg);
                } else if (checkName == "phone") {
                    document.getElementById('phone').value = "";
                    $("#phone").text(msg);
                }
                return false;

            } else {
                return true;
            }
        }
        function upperCase(x) {
            var y = document.getElementById(x).value;
            document.getElementById(x).value = y.toUpperCase();
        }



        function check_username() {
            $.post("account.html",
                  {
                      userName: $("#userName").val(),
                      rec: 'check_username'
                  },
                  function (returnedData) {
                      if (document.getElementById('userName').value == "") {
                      } else {
                          document.getElementById('userName').value = document.getElementById('userName').value.toUpperCase();
                          if (returnedData == -1) {
                              $("#userNameMsg1").text('');
                              $("#userNameMsg").text('此会员编号已存在');
                          }
                          else {
                              $("#userNameMsg").text('');
                          }
                      }
                  }
              );
        }

        function check_phone() {
            $.post("account.html", {
                phone: $("#phone").val(),
                rec: 'check_phone'
            },
                  function (returnedData) {
                      if (returnedData.sf == -1) {
                          $("#phonemsg1").text('');
                          $("#phonemsg").text('此手机号码已被注册三次');
                      } else {
                          $("#phonemsg").text('');
                      }

                  }
              );
        }

        function send_msg() {
            if ($.trim($("#phone").val()) == '') {
                alert('请先输入注册的手机号码!');
            } else if (!isNaN($("#phone").val()) && $.trim($("#phone").val()).length == 11) {
                $.ajax({
                    url: '/Home/',
                    type: 'POST',
                    data: { 'rec': 'send_sms', 'tel': $('#phone').val() },
                    success: function (data) {
                        if (data == 0) {
                            alert('发送成功，请注意查收!');
                            $('#btn_send_msg').attr("disabled", true);
                            show_timer();
                        } else if (data == -99) {
                            alert('手机号已注册过3次,不能再注册!')
                        } else {
                            alert('发送失败，请稍后重试!');
                        }
                    }
                })
            } else {
                alert('手机号码不正确，请重新输入!');
            }
        }
        var t;
        function show_timer() {
            $("#timer").show();
            var countdown = 120;
            t = setInterval(function () {
                $("#timer").text((countdown--) + '秒后可重新发送');
                if (countdown <= 0) {
                    clearInterval(t);
                    $("#timer").text('');
                    $("#timer").hide();
                    $('#btn_send_msg').removeAttr("disabled");
                }
            }, 1000);
        }
    </script>

</body>
</html>