
<!DOCTYPE html>
<html>
 <head> 
  <meta charset="UTF-8" /> 
  <title>登录</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
  <meta name="format-detection" content="telephone=no" /> 
  <link rel="stylesheet" type="text/css" href="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/styles/base.css" /> 
  <link rel="stylesheet" type="text/css" href="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/styles/master.css" /> 
 <style>
.recoinput {
	display: none;
}

.pop {
	display: none;
}

.phone_clear {
	display: none;
}

.w_popbj2 {
	display: none;
}

.w_popprotocol {
	display: none;
}
</style>
 </head> 
 <body> 
  <div class="main"> 
   <div class="w_loginbox"> 
    <h1> <img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/logo.png" alt="" /> </h1> 
    <div class="w_register"> 
     <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_01.fb021dd5.png" alt="" /></label> 
     <input type="text" placeholder="会员编号" name="username" id="username"  class="w_registerinput phoneNumber inputClass" maxlength="50" /> 
     <i class="w_clearicon"> <img class="phone_clear" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_close_02.png" alt="" /></i> 
    </div> 
    
    <div class="hr"></div> 
    <div class="w_register"> 
     <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_04.ce19cd10.png" alt="" /></label> 
     <input type="password" name="password" id="password" placeholder="登录密码"  class="w_registerinput inputClass password pwd" /> 
     <i class="w_clearicon"><img class="password_eye" src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_06.629f81c4.png" alt="" /> 
     </i> 
    </div> 
	
	<div class="vcodeblock"> 
     <div class="hr"></div> 
     <div class="w_register"> 
      <label class="w_labelicon"><img src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/images/w_login_04.ce19cd10.png" alt="" /></label> 
      <input type="text" type="text" id="yzm" name="yzm" placeholder="请输入验证码" class="w_registerinput inputClass picVerifyCode" maxlength="4" /> 
      <i class="w_verification"> <img id="vCode" onclick="refresh_src(this)" src="__ROOT__/Home/login/verify" /> </i> 
     </div> 
    </div> 
	
    <div class="hr"></div> 
    <div class="w_label_buttonbox"> 
     <button class="w_purebutton btnregister" type="button" onclick="submitLoginForm();" id="loginMainBtn" >立即登陆</button> 
    </div> 
    <div class="w_bottomtxt"> 
     <a href="{:U('/login/find_pwd')}" class="rose">忘记密码？</a> 
    </div> 
	
	<div id="login_error">
	<p style=" display:none;">We're sorry. Please try again！</p>
	</div>
   </div> 
  </div> 
  <script src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/javascripts/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/javascripts/bootstrap.js" type="text/javascript"></script>
<script src="http://yunsheng.oss-cn-beijing.aliyuncs.com/skin/javascripts/flickerplate.min.js" type="text/javascript"></script>
 
	<script type="text/javascript">	
    function refresh_src(obj){
	   $(obj).attr('src','__ROOT__/Home/login/verify?'+Math.random());
	}	
	  
	$(document).ready(function(){
		//回车的键值为13  
		document.onkeydown = function(event){  
		e = event ? event :(window.event ? window.event : null); 
		 if (e.keyCode == 13) {  
		    //js 监听对应的id  
		    document.getElementById("loginMainBtn").click();  
		    return false ;  
		 	} 
		}
		
		$('.flicker-login').flicker();
	});
		
	String.prototype.trim=function(){
	  return  this.replace(/(^s*)|(s*$)/g,"");
	}
	
		
		function submitLoginForm(){
			jQuery("#loginMainBtn").attr("disabled", "false");
			$("#login_error").hide();
			
			var userNameVal =  $("#username").val();
			if(userNameVal == ''){
				jQuery("#loginMainBtn").removeAttr("disabled");
				$("#login_error").show();
				$("#username").focus();
                $("#login_error").html(" <p class='alert'>登录失败，请检查以下信息："+
						"<br/>• 会员编号不能为空。"+
                		"</p>  ");
                return ;
			}
			
			var passwordVal =  $("#password").val();
			if(passwordVal == ''){
				jQuery("#loginMainBtn").removeAttr("disabled");
				$("#login_error").show();
				$("#password").focus();
                $("#login_error").html("<p class='alert'>登录失败，请检查以下信息："+
						'<br/>• 登录密码不能为空。'+
                		"</p>");
                return ;
			}
			
			var yzm = $("#yzm").val();
			if(yzm == ''){
				jQuery("#loginMainBtn").removeAttr("disabled");
				$("#login_error").show();
				$("#yzm").focus();
                $("#login_error").html("<p class='alert'>登录失败，请检查以下信息："+
						'<br/>• 验证码不能为空。'+
                		"</p>");
                return ;
			}
			
			jQuery.post("{:U('/Home/Login/logincl')}",
						{"rec":"login", "yzm":$.trim($("#yzm").val()), "account":$.trim($("#username").val()), "password":$.trim($(".pwd").val())},
						function(data){
						
						jQuery("#loginMainBtn").removeAttr("disabled");
						 if (1== data.sf) {
                      		$("#login_error").show();
                      		$("#login_error").html(" <p class='alert'>登录失败，请检查以下信息："+
							'<br/>• 会员编号和登录密码错误，请重新输入。'+
	                		"</p>");
                        }else if (0== data.sf) {
	                  	 $("#login_error").hide();
	                  	    window.location.href = "{:U('/home/user/index')}";
	                    }else if(2== data.sf){
						    $("#login_error").show();
                      		$("#login_error").html(" <p class='alert'>验证码不正确，请刷新重试!</p>");
						}
			});
		}
		
		function upperCase(x)   {
            var y=document.getElementById(x).value;
            document.getElementById(x).value=y.toUpperCase();
        }
		//去除缓存
		$.ajaxSetup({cache: false });
		
	</script>
    
 </body>
</html>