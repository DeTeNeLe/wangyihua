/*1127_yh*/function Tab(b,c,a){if(b.length<1){return}this.nav=b;this.body=c;this.eventType=a||"mouseover";this.execute()}Tab.prototype={execute:function(){var c=this;var a=c.nav.length;for(var b=0;b<a;b++){c.nav[b]._i=b;M.addHandler(c.nav[b],c.eventType,function(){for(var e=0;e<a;e++){M.removeClass(c.nav[e],"current");if(c.body){M.removeClass(c.body[e],"current")}}var d=this._i;M.addClass(this,"current");if(c.body){M.addClass(c.body[d],"current")}},c.nav[b])}}};function Focus(b,a,c,d){if(!a){return}this.nav=b;this.stage=a;this.step=c;this.desc=d;this.index=0;this.len=b.length;this.warp()}Focus.prototype={warp:function(){var c=this;for(var b=0;b<c.len;b++){c.nav[b]._key=b;c.nav[b].onmouseover=function(){c.index=this._key;clearInterval(auto);a()};c.nav[b].onmouseout=function(){c.index=this._key;auto=setInterval(function(){a()},5000)}}var a=function(){for(var d=0;d<c.len;d++){(c.nav[d].className.indexOf("current")>-1)?M.removeClass(c.nav[d],"current"):(function(){})()}M.addClass(c.nav[c.index],"current");M.Animate(c.stage,{marginTop:(0-c.step*c.index)+"px"});if(c.desc){c.desc.innerHTML=c.nav[c.index].getAttribute("data-alt")}c.index=(c.index>=c.len-1)?0:parseInt(c.index)+1};auto=setInterval(function(){a()},5000)}};var isLogin=0;function userLogin(){M.showLoginBox(function(){setLoginStatus();isLogin=1})}function setLoginStatus(){M.$("#JS_art_login_status").innerHTML=M.getCookie("ECS[username]");M.$("#JS_art_email").value=M.getCookie("ECS[email]")}function postComment(g){var e=M.$("#JS_art_content").value,b=M.$("#JS_art_email").value,h=g.getAttribute("data-id");var f=new RegExp("(?=https?://|(?:[a-z-]+.)+(?:aero|asia|arpa|biz|cc|cn|co|com|coop|edu|gov|info|int|jobs|me|mobi|mil|museum|name|nato|net|org|pro|tv|tel|travel))(?:https?:)?[a-z&/?.-=]*");if(e.length<=0||e==""){alert("请填写评论内容!");return}else{if(e.search(f)!=-1){alert("评论内容不能包含网址!");return}}var d=b.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/);if(b==""||d==-1){alert("请填写有效的邮箱地址!");return}if(isLogin){uName=M.$("#JS_art_login_status").innerHTML}else{uName="匿名"}var a=new Date(),c=a.getFullYear()+"-"+parseInt(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();M.ajax({url:"/add_article_comments.html",type:"POST",dataType:"json",data:"article_id="+h+"&name="+uName+"&email="+b+"&content="+e,success:function(i){if(i.error==0){alert("发表成功！待管理员审核！");M.$("#JS_art_content").value="";M.$("#JS_art_email").value="";M.$("#Js_txtInfo").innerHTML="200"}},error:function(i){if(i.error==1){alert("提交失败，请稍后重试！")}}})}function getData(b){var a=M.$("#JS_comment_pager").getAttribute("data-page");if(b=="one"&&a>1){makeCmtPage(b,a)}if(b=="one"){return false}else{var c=M.$("#JS_comment_pager").getAttribute("data-id");M.ajax({url:"/article/?act=get_article_comments&id="+c+"&page="+b,dataType:"json",type:"GET",success:function(d){var f;if(d.error==0){var e=[];var g=d.list;for(k in g){e.push('<div class="list"><h4>美乐乐 '+g[k].ip+" 网友 "+g[k].name+" ("+g[k].add_time+")</h4><p>"+g[k].content+"</p></div>")}f=e.join("");makeCmtPage(b,a)}else{f="暂无评论"}M.$("#JS_comment_list").innerHTML=f}})}}function makeCmtPage(e,a){e=e=="one"?1:e;var d=[];var c=e-1;if(c<1){c=1}var b=e+1;if(b>a){b=a}d.push('第<b class="red">'+e+'</b>页/共<b class="red">'+a+"</b>页&ensp;");d.push('<a href="javascript:;" onclick="getData(1);return !1;">首页</a>&ensp;');d.push('<a href="javascript:;" onclick="getData('+c+');return !1;">上一页</a>&ensp;');d.push('<a href="javascript:;" onclick="getData('+b+');return !1;">下一页</a>&ensp;');d.push('<a href="javascript:;" onclick="getData('+a+');return !1;">末页</a>');M.$("#JS_comment_pager").innerHTML=d.join("")}function commentKeyup(){var b=M.$("#JS_art_content");var a=M.$("#Js_txtInfo");a.innerHTML=200-b.value.length;b.onkeyup=function(){var c=this.value.length;var d=200-c;if(d>=0){a.innerHTML=d}else{this.value=this.value.substr(0,200);a.innerHTML=0;alert("您输入评论字数超出了200字！")}}};